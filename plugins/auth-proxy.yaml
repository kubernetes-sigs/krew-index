apiVersion: krew.googlecontainertools.github.com/v1alpha2
kind: Plugin
metadata:
  name: auth-proxy
spec:
  homepage: https://github.com/int128/kauthproxy
  shortDescription: Authentication proxy to a pod or service
  description: |
    This is a kubectl plugin to forward a local port to a pod or service via the authentication proxy.
    It gets a token from the current credential plugin (e.g. aws-iam-authenticator or kubelogin).
    Then it appends the authorization header to HTTP requests, like `authorization: Bearer token`.
    All traffic is routed by the authentication proxy and port forwarder as follows:
      [browser] -> [authentication proxy] -> [port forwarder] -> [pod]

  caveats: |
    You need to configure authentication in the kubeconfig.
    See https://github.com/int128/kauthproxy for more.

  version: v1.2.5
  platforms:
  - bin: kauthproxy
    uri: https://github.com/int128/kauthproxy/releases/download/v1.2.5/kauthproxy_linux_amd64.zip
    sha256: 95251c4914224eef3307ff96fe24aab343e4420c4c38b7165ddd3fa921dcd169
    selector:
      matchLabels:
        os: linux
        arch: amd64
  - bin: kauthproxy
    uri: https://github.com/int128/kauthproxy/releases/download/v1.2.5/kauthproxy_linux_arm64.zip
    sha256: ae5cfa8a23ab21e7c0fa8a60b2f256adcb493caf20f1666b3808fa46d84f64a8
    selector:
      matchLabels:
        os: linux
        arch: arm64
  - bin: kauthproxy
    uri: https://github.com/int128/kauthproxy/releases/download/v1.2.5/kauthproxy_linux_arm.zip
    sha256: 135c2fc5e47c4996689294c52aac08b9538e43ae67c57f064fd38d693d3bab69
    selector:
      matchLabels:
        os: linux
        arch: arm
  - bin: kauthproxy
    uri: https://github.com/int128/kauthproxy/releases/download/v1.2.5/kauthproxy_darwin_amd64.zip
    sha256: 9d037d43851c904e6a2784bdf2a37299646beda3dde005e6aa5a8db9f1649d2b
    selector:
      matchLabels:
        os: darwin
        arch: amd64
  - bin: kauthproxy
    uri: https://github.com/int128/kauthproxy/releases/download/v1.2.5/kauthproxy_darwin_arm64.zip
    sha256: db3d6d164337dde39c59a0832decde9db3afec2e7648422db22702aca637dfa8
    selector:
      matchLabels:
        os: darwin
        arch: arm64
  - bin: kauthproxy.exe
    uri: https://github.com/int128/kauthproxy/releases/download/v1.2.5/kauthproxy_windows_amd64.zip
    sha256: 4a3e3e926b88b83ca5bdb662dd6165c6dcfdf6de153866949832f81f85f44328
    selector:
      matchLabels:
        os: windows
        arch: amd64
