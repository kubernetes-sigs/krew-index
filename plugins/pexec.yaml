apiVersion: krew.googlecontainertools.github.com/v1alpha2
kind: Plugin
metadata:
  name: pexec
spec:
  homepage: https://github.com/ssup2/kpexec
  shortDescription: Execute process with privileges in a pod
  description: |
    pexec is a kubernetes cli that runs commands in a container with high
    privileges. It runs a highly privileged container on the same node as
    the target container and joins into the namespaces of the target container
    (IPC, UTS, PID, net, mount). This is useful for debugging where you often
    need to execute commands with high privileges. Also, pexec has a tools
    mode, which adds useful debugging tools into the debugged container. The
    tools mode is useful when there necessary debugging tools are missing in the
    target container.

    In contrast, kubectl-exec runs the command with the same privileges as the
    container. For example, if a container does not have network privileges,
    the command executed by kubectl-exec also has no network privileges.
    This makes debugging the pod difficult. If you use pexec instead
    of kubectl-exec, you can easily get high privileges for debugging.
  caveats: |
    pexec requires the privileges to run privileged pods with hostPID.
  version: "v0.4.5"
  platforms:
  - bin: kubectl-pexec
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.5/kubectl_pexec_v0.4.5_Linux_amd64.tar.gz
    sha256: 7f0940f2e60bb654540f5d6313ebd6d864dd7ce46e84a30d775aaf518a58648d
    selector:
      matchLabels:
        os: linux
        arch: amd64
  - bin: kubectl-pexec
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.5/kubectl_pexec_v0.4.5_Linux_arm64.tar.gz
    sha256: b4bc3f91094870f5135c8cb29415c2fbd34e6e91eacdb5fcfcb4094daa596c77
    selector:
      matchLabels:
        os: linux
        arch: arm64
  - bin: kubectl-pexec
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.5/kubectl_pexec_v0.4.5_Darwin_amd64.tar.gz
    sha256: fb68c9e5b79c804ebda30644acdc114a4dde4f608bc4604322575a96a5d538e0
    selector:
      matchLabels:
        os: darwin
        arch: amd64
  - bin: kubectl-pexec
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.5/kubectl_pexec_v0.4.5_Darwin_arm64.tar.gz
    sha256: 737b5a9a9220b3eaf01f1cffaf72304a83466a291ead52db6656079222557301
    selector:
      matchLabels:
        os: darwin
        arch: arm64
  - bin: kubectl-pexec.exe
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.5/kubectl_pexec_v0.4.5_Windows_amd64.tar.gz
    sha256: 16af7554d03b8f4cfeda0520cde8329d41e59a68f4105571e75170ffb9f2d184
    selector:
      matchLabels:
        os: windows
        arch: amd64
