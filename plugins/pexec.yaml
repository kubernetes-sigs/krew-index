apiVersion: krew.googlecontainertools.github.com/v1alpha2
kind: Plugin
metadata:
  name: pexec
spec:
  homepage: https://github.com/ssup2/kpexec
  shortDescription: Execute process with privileges in a pod
  description: |
    pexec is a kubernetes cli that runs commands in a container with high
    privileges. It runs a highly privileged container on the same node as
    the target container and joins into the namespaces of the target container
    (IPC, UTS, PID, net, mount). This is useful for debugging where you often
    need to execute commands with high privileges. Also, pexec has a tools
    mode, which adds useful debugging tools into the debugged container. The
    tools mode is useful when there necessary debugging tools are missing in the
    target container.

    In contrast, kubectl-exec runs the command with the same privileges as the
    container. For example, if a container does not have network privileges,
    the command executed by kubectl-exec also has no network privileges.
    This makes debugging the pod difficult. If you use pexec instead
    of kubectl-exec, you can easily get high privileges for debugging.
  caveats: |
    pexec requires the privileges to run privileged pods with hostPID.
  version: "v0.4.6"
  platforms:
  - bin: kubectl-pexec
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.6/kubectl_pexec_v0.4.6_linux_amd64.tar.gz
    sha256: 781cce121c7e206bf2c13f45982f36b379f4613d9515558b7631e9fc93956c07
    selector:
      matchLabels:
        os: linux
        arch: amd64
  - bin: kubectl-pexec
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.6/kubectl_pexec_v0.4.6_linux_arm64.tar.gz
    sha256: dc770abdd01d739a668da7f634357088a88f2cfa99062ba957813ea9929bf224
    selector:
      matchLabels:
        os: linux
        arch: arm64
  - bin: kubectl-pexec
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.6/kubectl_pexec_v0.4.6_darwin_amd64.tar.gz
    sha256: 17d518f934216130295273b5e420527487972added804e20aa63a98b5970085e
    selector:
      matchLabels:
        os: darwin
        arch: amd64
  - bin: kubectl-pexec
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.6/kubectl_pexec_v0.4.6_darwin_arm64.tar.gz
    sha256: a1067ba1952022a80e61bd18ebdd035e0a2a850cb01c174e41bbdbe7a2ff8578
    selector:
      matchLabels:
        os: darwin
        arch: arm64
  - bin: kubectl-pexec.exe
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.6/kubectl_pexec_v0.4.6_windows_amd64.tar.gz
    sha256: 3111f8bcced5d2ba032074f910512051581a7a0f4af0e77f0b60c47781d10843
    selector:
      matchLabels:
        os: windows
        arch: amd64
  - bin: kubectl-pexec.exe
    uri: https://github.com/ssup2/kpexec/releases/download/v0.4.6/kubectl_pexec_v0.4.6_windows_amd64.tar.gz
    sha256: 3111f8bcced5d2ba032074f910512051581a7a0f4af0e77f0b60c47781d10843
    selector:
      matchLabels:
        os: windows
        arch: arm64
